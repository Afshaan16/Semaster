


 DECLARE CURSOR C1 IS SELECT EMPNO, ENAME, JOB FROM EMPLOYEEE WHERE DEPTNO = 10;
 BEGIN
FOR REC IN C1 LOOP
 DBMS_OUTPUT.PUT_LINE ('EMPNO' || REC.EMPNO);
 DBMS_OUTPUT.PUT_LINE ('ENAME' || REC.ENAME);
 DBMS_OUTPUT.PUT_LINE ('JOB' || REC.JOB); 
END LOOP;
END;




 DECLARE
OLDSAL NUMBER;
 NEWSAL NUMBER; 
CURSOR C1 IS SELECT * FROM EMPLOYEEE; 
REC C1%ROWTYPE;
BEGIN


FOR REC IN C1

 SELECT SAL INTO OLDSAL FROM EMPLOYEEE WHERE EMPNO=REC.EMPNO;
 IF REC.DEPTNO=10 THEN UPDATE EMPLOYEEE SET SAL=SAL+1000 WHERE EMPNO=REC.EMPNO;
 SELECT SAL INTO NEWSAL FROM EMPLOYEEE WHERE EMPNO=REC.EMPNO; 
END IF;
 INSERT INTO TEMP (EMPID, OLD, NEW) VALUES (REC.EMPNO, OLDSAL, NEWSAL);
 END LOOP;

END;



b)
CREATE OR REPLACE TRIGGER
 UPDATE_CHECK BEFORE UPDATE ON EMPLOYEEE
 FOR EACH ROW BEGIN IF
 :NEW.SAL<:OLD.SAL THEN RAISE_APPLICATION_ERROR (-20001,’NEW SALARY CANNOT BE LESS THAN OLD SALARY’); 
END IF; 
END;
Output:

SQL> update employeee
  2  set sal=10
  3  where ename='jones';
update employeee
       *
ERROR at line 1:
ORA-04098: trigger 'SYSTEM.DEPT_UP' is invalid and failed re-validation








c)
 CREATE OR REPLACE TRIGGER DEPT_UP  
         AFTER UPDATE ON EMPLOYEEE FOR EACH ROW 
  DECLARE         
 v_num NUMBER (3);   
 BEGIN 
  SELECT COUNT (*) INTO v_num FROM EMPLOYEEE WHERE deptno=20;  
 IF v_num > 4 
       Raise_application_error (-20001,’Cannot Exceed 4’);  
 END; 
Output:

SQL> insert into employeee(ename,empno,deptno)values('aziz',10,20);
insert into employeee(ename,empno,deptno)values('aziz',10,20)
*
ERROR at line 1:
ORA-00001: unique constraint (SYSTEM.SYS_C007001) violated